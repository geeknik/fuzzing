{
  "<start>": [
    ["<privateKeyFile>"],
    ["<publicKeyFile>"],
    ["<sshPacket>"]
  ],

  /* ---------- OpenSSH PRIVATE KEY (PEM) ---------- */

  "<privateKeyFile>": [
    ["-----BEGIN OPENSSH PRIVATE KEY-----\n", "<base64Block>", "-----END OPENSSH PRIVATE KEY-----\n"]
  ],
  "<base64Block>": [
    ["<base64Line>", "<base64Block>"],
    ["<base64Line>"]
  ],
  "<base64Line>": [
    ["<base64Characters>\n"]
  ],
  "<base64Characters>": [
    ["<base64Char>", "<base64Characters>"],
    []
  ],
  "<base64Char>": [
    ["A"], ["B"], ["C"], ["D"], ["E"], ["F"], ["G"], ["H"], ["I"], ["J"],
    ["K"], ["L"], ["M"], ["N"], ["O"], ["P"], ["Q"], ["R"], ["S"], ["T"],
    ["U"], ["V"], ["W"], ["X"], ["Y"], ["Z"], ["a"], ["b"], ["c"], ["d"],
    ["e"], ["f"], ["g"], ["h"], ["i"], ["j"], ["k"], ["l"], ["m"], ["n"],
    ["o"], ["p"], ["q"], ["r"], ["s"], ["t"], ["u"], ["v"], ["w"], ["x"],
    ["y"], ["z"], ["0"], ["1"], ["2"], ["3"], ["4"], ["5"], ["6"], ["7"],
    ["8"], ["9"], ["+"], ["/"], ["="]
  ],

  /* ---------- OpenSSH binary “openssh-key-v1” structure (hex) ---------- */

  "<privateKeyBinary>": [
    ["<header>", "<cipher>", "<kdf>", "<kdfoptions>", "<numKeys>", "<pubKey>", "<privKeyData>"]
  ],
  "<header>": [
    ["6F70656E7373682D6B65792D763100"]        /* "openssh-key-v1\\0" */
  ],
  "<cipher>": [
    ["000000046E6F6E65"],                    /* "none" */
    ["00000006616573323536"],               /* "aes256" (legacy) */
    ["0000000A6165733235362D637472"],       /* "aes256-ctr" */
    ["0000002263686163686132302D706F6C7931333035406F70656E7373682E636F6D"], /* "chacha20-poly1305@openssh.com" */
    ["000000126165733235362D67636D406F70656E7373682E636F6D"]                /* "aes256-gcm@openssh.com" */
  ],
  "<kdf>": [
    ["000000046E6F6E65"],                   /* "none" */
    ["00000009626372797074"]                /* "bcrypt" */
  ],
  "<kdfoptions>": [
    ["00000000"],                           /* empty options */
    ["@len <kdfSaltRounds>", "<kdfSaltRounds>"]
  ],
  "<kdfSaltRounds>": [
    ["<bytes>", "<uint32>"]
  ],
  "<numKeys>": [
    ["00000001"],
    ["00000002"]
  ],

  /* --- public key (binary) --- */

  "<pubKey>": [
    ["@len <pubKeyData>", "<pubKeyData>"]
  ],
  "<pubKeyData>": [
    /* ssh-rsa */
    ["000000077373682D727361", "<mpint_e>", "<mpint_n>"],
    /* ssh-ed25519: string "ssh-ed25519" + 32-byte pubkey */
    ["0000000B7373682D65643235353139", "@len <bytes>", "<bytes>"],
    /* ecdsa-sha2-nistp256: type, curve name, Q */
    ["0000001365636473612D736861322D6E69737470323536", "@len <ecdsaCurve>", "<ecdsaCurve>", "@len <bytes>", "<bytes>"]
  ],
  "<ecdsaCurve>": [
    ["6E69737470323536"]                    /* "nistp256" */
  ],

  /* --- private key (binary) --- */

  "<privKeyData>": [
    ["@len <privKeyContent>", "<privKeyContent>"]
  ],
  "<privKeyContent>": [
    ["<checkint1>", "<checkint2>", "<keytype>", "<keyBody>", "<padding>"]
  ],
  "<checkint1>": [["<uint32>"]],
  "<checkint2>": [["<uint32>"]],

  "<keytype>": [
    ["000000077373682D727361"],             /* "ssh-rsa" */
    ["0000001365636473612D736861322D6E69737470323536"], /* "ecdsa-sha2-nistp256" */
    ["0000000B7373682D65643235353139"]      /* "ssh-ed25519" */
  ],

  "<keyBody>": [
    /* rsa key body */
    ["<mpint_n>", "<mpint_e>", "<mpint_d>", "<mpint_iqmp>", "<mpint_p>", "<mpint_q>"],
    /* ecdsa: private scalar + public Q */
    ["@mpint <bytes>", "@len <bytes>", "<bytes>"],
    /* ed25519: 32-byte public + 64-byte private+public */
    ["@len <bytes>", "<bytes>", "@len <bytes>", "<bytes>"]
  ],

  "<mpint_n>": [["@mpint <bytes>"]],
  "<mpint_e>": [["@mpint <bytes>"]],
  "<mpint_d>": [["@mpint <bytes>"]],
  "<mpint_iqmp>": [["@mpint <bytes>"]],
  "<mpint_p>": [["@mpint <bytes>"]],
  "<mpint_q>": [["@mpint <bytes>"]],

  "<padding>": [["<bytes>"]],

  /* ---------- OpenSSH public key (authorized_keys style) ---------- */

  "<publicKeyFile>": [
    ["<pubKeyType> ", "<base64PubKey>", " ", "<comment>", "\n"],
    ["<pubKeyType> ", "<base64PubKey>", "\n"]
  ],
  "<pubKeyType>": [
    ["ssh-rsa"],
    ["ssh-ed25519"],
    ["ecdsa-sha2-nistp256"],
    ["ecdsa-sha2-nistp384"],
    ["ecdsa-sha2-nistp521"],
    ["ssh-rsa-cert-v01@openssh.com"],
    ["ssh-ed25519-cert-v01@openssh.com"]
  ],
  "<base64PubKey>": [
    ["<base64Characters>"]
  ],
  "<comment>": [
    ["user@host"],
    ["test"],
    ["root@localhost"],
    ["fuzz@target"],
    [""]
  ],

  /* ---------- SSH protocol packet-ish shapes (hex) ---------- */

  "<sshPacket>": [
    ["<sshVersionString>"],
    ["<kexInitPacket>"],
    ["<authRequestPacket>"],
    ["<channelOpenPacket>"]
  ],

  "<sshVersionString>": [
    ["SSH-", "<versionNumber>", "-", "<softwareName>", "\r\n"]
  ],
  "<versionNumber>": [
    ["2.0"],
    ["1.99"],
    ["<digits>", ".", "<digits>"]
  ],
  "<softwareName>": [
    ["OpenSSH_<versionNumber>"],
    ["Dropbear_<versionNumber>"],
    ["libssh_<versionNumber>"],
    ["<string>"]
  ],

  "<kexInitPacket>": [
    ["@len <kexInitData>", "<kexInitData>"]
  ],
  "<kexInitData>": [
    ["14", "<cookie>", "<kexAlgorithms>", "<serverHostKeyAlgorithms>", "<encryptionAlgorithms>", "<macAlgorithms>", "<compressionAlgorithms>", "<languages>", "<firstKexPacketFollows>"]
  ],
  "<cookie>": [["<bytes>"]],

  "<kexAlgorithms>": [
    ["@len <stringList>", "<stringList>"]
  ],
  "<serverHostKeyAlgorithms>": [
    ["@len <stringList>", "<stringList>"]
  ],
  "<encryptionAlgorithms>": [
    ["@len <stringList>", "<stringList>"]
  ],
  "<macAlgorithms>": [
    ["@len <stringList>", "<stringList>"]
  ],
  "<compressionAlgorithms>": [
    ["@len <stringList>", "<stringList>"]
  ],
  "<languages>": [
    ["@len <stringList>", "<stringList>"]
  ],
  "<firstKexPacketFollows>": [
    ["00"],
    ["01"]
  ],

  "<stringList>": [
    ["<string>", ",", "<stringList>"],
    ["<string>"]
  ],

  "<authRequestPacket>": [
    ["@len <authRequestData>", "<authRequestData>"]
  ],
  "<authRequestData>": [
    ["32", "<username>", "<serviceName>", "<methodName>", "<methodData>"]
  ],

  "<username>": [
    ["@len <string>", "<string>"]
  ],
  "<serviceName>": [
    ["0000000C7373682D636F6E6E656374696F6E"],   /* "ssh-connection" */
    ["0000000473756263"]                        /* "subc" (odd) */
  ],
  "<methodName>": [
    ["0000000670617373776F7264"],               /* "password" */
    ["0000000A7075626C69636B6579"],             /* "publickey" */
    ["000000136B6579626F6172642D696E746572616374697665"]  /* "keyboard-interactive" */
  ],
  "<methodData>": [
    ["<passwordData>"],
    ["<pubkeyData>"]
  ],
  "<passwordData>": [
    ["00", "@len <string>", "<string>"]
  ],
  "<pubkeyData>": [
    ["01", "@len <string>", "<string>", "@len <string>", "<string>"]
  ],

  "<channelOpenPacket>": [
    ["@len <channelOpenData>", "<channelOpenData>"]
  ],
  "<channelOpenData>": [
    ["11", "<channelType>", "<senderChannel>", "<initialWindowSize>", "<maxPacketSize>", "<channelSpecificData>"]
  ],
  "<channelType>": [
    ["0000000773657373696F6E"],                /* "session" */
    ["0000000A6469726563742D743970"]           /* "direct-tcpip" */
  ],
  "<senderChannel>": [["<uint32>"]],
  "<initialWindowSize>": [["<uint32>"]],
  "<maxPacketSize>": [["<uint32>"]],
  "<channelSpecificData>": [["<bytes>"]],

  /* ---------- Shared primitives ---------- */

  "<string>": [
    ["<char>", "<string>"],
    []
  ],
  "<char>": [
    ["a"], ["b"], ["c"], ["d"], ["e"], ["f"], ["g"], ["h"], ["i"], ["j"],
    ["k"], ["l"], ["m"], ["n"], ["o"], ["p"], ["q"], ["r"], ["s"], ["t"],
    ["u"], ["v"], ["w"], ["x"], ["y"], ["z"], ["A"], ["B"], ["C"], ["D"],
    ["E"], ["F"], ["G"], ["H"], ["I"], ["J"], ["K"], ["L"], ["M"], ["N"],
    ["O"], ["P"], ["Q"], ["R"], ["S"], ["T"], ["U"], ["V"], ["W"], ["X"],
    ["Y"], ["Z"], ["0"], ["1"], ["2"], ["3"], ["4"], ["5"], ["6"], ["7"],
    ["8"], ["9"], ["-"], ["_"], ["@"], ["."], [":"]
  ],

  "<digits>": [
    ["<digit>", "<digits>"],
    ["<digit>"]
  ],
  "<digit>": [
    ["0"], ["1"], ["2"], ["3"], ["4"], ["5"], ["6"], ["7"], ["8"], ["9"]
  ],

  "<uint32>": [
    ["<byte>", "<byte>", "<byte>", "<byte>"]
  ],
  "<bytes>": [
    ["<byte>", "<bytes>"],
    []
  ],
  "<byte>": [
    ["00"], ["01"], ["02"], ["03"], ["04"], ["05"], ["06"], ["07"], ["08"], ["09"],
    ["0A"], ["0B"], ["0C"], ["0D"], ["0E"], ["0F"], ["10"], ["11"], ["12"], ["13"],
    ["14"], ["15"], ["16"], ["17"], ["18"], ["19"], ["1A"], ["1B"], ["1C"], ["1D"],
    ["1E"], ["1F"], ["20"], ["21"], ["22"], ["23"], ["24"], ["25"], ["26"], ["27"],
    ["28"], ["29"], ["2A"], ["2B"], ["2C"], ["2D"], ["2E"], ["2F"], ["30"], ["31"],
    ["32"], ["33"], ["34"], ["35"], ["36"], ["37"], ["38"], ["39"], ["3A"], ["3B"],
    ["3C"], ["3D"], ["3E"], ["3F"], ["40"], ["41"], ["42"], ["43"], ["44"], ["45"],
    ["46"], ["47"], ["48"], ["49"], ["4A"], ["4B"], ["4C"], ["4D"], ["4E"], ["4F"],
    ["50"], ["51"], ["52"], ["53"], ["54"], ["55"], ["56"], ["57"], ["58"], ["59"],
    ["5A"], ["5B"], ["5C"], ["5D"], ["5E"], ["5F"], ["60"], ["61"], ["62"], ["63"],
    ["64"], ["65"], ["66"], ["67"], ["68"], ["69"], ["6A"], ["6B"], ["6C"], ["6D"],
    ["6E"], ["6F"], ["70"], ["71"], ["72"], ["73"], ["74"], ["75"], ["76"], ["77"],
    ["78"], ["79"], ["7A"], ["7B"], ["7C"], ["7D"], ["7E"], ["7F"], ["80"], ["81"],
    ["82"], ["83"], ["84"], ["85"], ["86"], ["87"], ["88"], ["89"], ["8A"], ["8B"],
    ["8C"], ["8D"], ["8E"], ["8F"], ["90"], ["91"], ["92"], ["93"], ["94"], ["95"],
    ["96"], ["97"], ["98"], ["99"], ["9A"], ["9B"], ["9C"], ["9D"], ["9E"], ["9F"],
    ["A0"], ["A1"], ["A2"], ["A3"], ["A4"], ["A5"], ["A6"], ["A7"], ["A8"], ["A9"],
    ["AA"], ["AB"], ["AC"], ["AD"], ["AE"], ["AF"], ["B0"], ["B1"], ["B2"], ["B3"],
    ["B4"], ["B5"], ["B6"], ["B7"], ["B8"], ["B9"], ["BA"], ["BB"], ["BC"], ["BD"],
    ["BE"], ["BF"], ["C0"], ["C1"], ["C2"], ["C3"], ["C4"], ["C5"], ["C6"], ["C7"],
    ["C8"], ["C9"], ["CA"], ["CB"], ["CC"], ["CD"], ["CE"], ["CF"], ["D0"], ["D1"],
    ["D2"], ["D3"], ["D4"], ["D5"], ["D6"], ["D7"], ["D8"], ["D9"], ["DA"], ["DB"],
    ["DC"], ["DD"], ["DE"], ["DF"], ["E0"], ["E1"], ["E2"], ["E3"], ["E4"], ["E5"],
    ["E6"], ["E7"], ["E8"], ["E9"], ["EA"], ["EB"], ["EC"], ["ED"], ["EE"], ["EF"],
    ["F0"], ["F1"], ["F2"], ["F3"], ["F4"], ["F5"], ["F6"], ["F7"], ["F8"], ["F9"],
    ["FA"], ["FB"], ["FC"], ["FD"], ["FE"], ["FF"]
  ]
}
